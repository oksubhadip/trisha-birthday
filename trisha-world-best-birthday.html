<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>World's Best Birthday Wish for Trisha! ‚ù§Ô∏è‚ú®üéÇüéà</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(45deg, #ff69b4, #ffb6c1, #ff69b4);
            background-size: 200% 200%;
            animation: gradientShift 8s ease infinite;
            color: #fff;
            text-align: center;
            margin: 0;
            padding: 0;
            overflow: hidden;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            touch-action: manipulation; /* Optimize touch */
        }
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        h1 {
            font-size: clamp(1.8em, 6vw, 2.5em);
            animation: fadeIn 2s ease-in-out, glow 2s infinite alternate;
            margin: 10px;
        }
        @keyframes glow {
            from { text-shadow: 0 0 8px #fff; }
            to { text-shadow: 0 0 15px #ff69b4; }
        }
        #message {
            font-size: clamp(1em, 4vw, 1.2em);
            max-width: 90%;
            margin: 10px auto;
            white-space: pre-wrap;
        }
        #heart, #cake, #gift {
            font-size: clamp(5em, 20vw, 8em);
            cursor: pointer;
            position: absolute;
            user-select: none;
            touch-action: none;
            z-index: 10;
        }
        #heart {
            animation: pulse 1.5s infinite, sparkle 3s infinite;
        }
        #cake {
            font-size: clamp(4em, 15vw, 6em);
            animation: bounce 2s infinite;
            transform-style: preserve-3d;
            perspective: 1000px;
            animation: bounce 2s infinite, rotate3d 10s infinite linear;
        }
        #gift {
            font-size: clamp(3em, 12vw, 5em);
            animation: shake 1s infinite, sparkle 4s infinite;
        }
        @keyframes sparkle {
            0%, 100% { filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.8)); }
            50% { filter: drop-shadow(0 0 15px rgba(255, 215, 0, 1)); }
        }
        @keyframes rotate3d {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(360deg); }
        }
        @keyframes shake {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-5deg); }
            75% { transform: rotate(5deg); }
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0) rotateY(0deg); }
            50% { transform: translateY(-8px) rotateY(0deg); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: 1;
        }
        #balloons {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: auto;
            z-index: 5;
        }
        #instructions {
            font-size: clamp(0.9em, 3.5vw, 1em);
            margin: 10px;
            z-index: 10;
            position: relative;
        }
        .pop-word, .gift-message {
            position: absolute;
            font-size: clamp(1.2em, 5vw, 1.5em);
            color: #fff;
            text-shadow: 0 0 8px #ff69b4;
            pointer-events: none;
            z-index: 15;
            animation: floatUp 2s ease-out forwards, rainbow 1s infinite;
        }
        @keyframes rainbow {
            0% { color: #ff69b4; }
            25% { color: #ffd700; }
            50% { color: #00ff00; }
            75% { color: #00b7eb; }
            100% { color: #ff69b4; }
        }
        @keyframes floatUp {
            0% { opacity: 1; transform: translateY(0) rotate(0deg); }
            100% { opacity: 0; transform: translateY(-50px) rotate(360deg); }
        }
        #fireworks, #trail {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 20;
        }
        audio {
            display: none;
        }
    </style>
</head>
<body>
    <canvas id="confetti"></canvas>
    <canvas id="balloons"></canvas>
    <canvas id="fireworks"></canvas>
    <canvas id="trail"></canvas>
    <h1>World's Best Birthday Wish for My Love, Trisha! üéâ‚ú®üéÇüéà</h1>
    <p id="message"></p>
    <p id="instructions">Drag the heart ‚ù§Ô∏è, cake üéÇ, and gift üéÅ with your fingers! Pop balloons üéà for sweet names, tap the cake for fireworks, open the gift for a surprise. All for you, my Mew! üíï</p>
    <div id="heart">‚ù§Ô∏è</div>
    <div id="cake">üéÇ</div>
    <div id="gift">üéÅ</div>
    <audio id="birthdaySong" loop>
        <source src="https://www.soundjay.com/buttons/happy-birthday-music.mp3" type="audio/mpeg">
        <!-- Placeholder; replace with real free audio URL if needed -->
    </audio>

    <script>
        // Typewriter effect for message
        const messageText = "Happy Birthday, Trisha! You're my world, my sweet Madhurima, my cute Cat, my adorable Baccha. Every moment with you sparkles like magic. Here's to endless love and joy! üåüüíñ";
        const messageElement = document.getElementById('message');
        let i = 0;
        function typeWriter() {
            if (i < messageText.length) {
                messageElement.innerHTML += messageText.charAt(i);
                i++;
                setTimeout(typeWriter, 40); // Faster for mobile
            }
        }
        typeWriter();

        // Draggable elements with trail
        function makeDraggable(element) {
            let isDragging = false;
            let startX, startY, initialX, initialY;
            const trailParticles = [];

            function startDrag(e) {
                isDragging = true;
                element.style.animation = 'none';
                if (e.type === 'touchstart') {
                    startX = e.touches[0].clientX;
                    startY = e.touches[0].clientY;
                } else {
                    startX = e.clientX;
                    startY = e.clientY;
                }
                initialX = element.offsetLeft;
                initialY = element.offsetTop;
                // Haptic feedback for mobile
                if (navigator.vibrate) navigator.vibrate(50);
            }

            function drag(e) {
                if (isDragging) {
                    e.preventDefault();
                    let currentX, currentY;
                    if (e.type === 'touchmove') {
                        currentX = e.touches[0].clientX;
                        currentY = e.touches[0].clientY;
                    } else {
                        currentX = e.clientX;
                        currentY = e.clientY;
                    }
                    const dx = currentX - startX;
                    const dy = currentY - startY;
                    element.style.left = `${initialX + dx}px`;
                    element.style.top = `${initialY + dy}px`;
                    // Add trail particle
                    trailParticles.push({
                        x: initialX + dx + element.offsetWidth / 2,
                        y: initialY + dy + element.offsetHeight / 2,
                        size: Math.random() * 5 + 3,
                        life: 30,
                        color: `hsl(${Math.random() * 360}, 100%, 50%)`
                    });
                }
            }

            function endDrag() {
                isDragging = false;
                if (element.id === 'heart') {
                    element.style.animation = 'pulse 1.5s infinite, sparkle 3s infinite';
                } else if (element.id === 'cake') {
                    element.style.animation = 'bounce 2s infinite, rotate3d 10s infinite linear';
                } else if (element.id === 'gift') {
                    element.style.animation = 'shake 1s infinite, sparkle 4s infinite';
                }
                if (navigator.vibrate) navigator.vibrate(50);
            }

            element.addEventListener('mousedown', startDrag);
            element.addEventListener('touchstart', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag, { passive: false });
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);

            // Trail animation
            const trailCanvas = document.getElementById('trail');
            const trailCtx = trailCanvas.getContext('2d');
            trailCanvas.width = window.innerWidth;
            trailCanvas.height = window.innerHeight;

            function animateTrail() {
                trailCtx.clearRect(0, 0, trailCanvas.width, trailCanvas.height);
                trailParticles.forEach((p, index) => {
                    p.life -= 1;
                    if (p.life <= 0) {
                        trailParticles.splice(index, 1);
                        return;
                    }
                    trailCtx.beginPath();
                    trailCtx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    trailCtx.fillStyle = p.color;
                    trailCtx.globalAlpha = p.life / 30;
                    trailCtx.fill();
                });
                trailCtx.globalAlpha = 1;
                requestAnimationFrame(animateTrail);
            }
            animateTrail();
        }

        const heart = document.getElementById('heart');
        makeDraggable(heart);
        heart.style.left = `${(window.innerWidth / 2) - 120}px`;
        heart.style.top = `${(window.innerHeight / 2) + 100}px`;

        const cake = document.getElementById('cake');
        makeDraggable(cake);
        cake.style.left = `${(window.innerWidth / 2)}px`;
        cake.style.top = `${(window.innerHeight / 2) + 100}px`;

        const gift = document.getElementById('gift');
        makeDraggable(gift);
        gift.style.left = `${(window.innerWidth / 2) + 120}px`;
        gift.style.top = `${(window.innerHeight / 2) + 100}px`;

        // Confetti effect (optimized for mobile)
        const confettiCanvas = document.getElementById('confetti');
        const ctx = confettiCanvas.getContext('2d');
        confettiCanvas.width = window.innerWidth;
        confettiCanvas.height = window.innerHeight;

        const confettiPieces = [];
        for (let i = 0; i < 80; // Reduced for mobile
             i++) {
            confettiPieces.push({
                x: Math.random() * confettiCanvas.width,
                y: Math.random() * confettiCanvas.height - confettiCanvas.height,
                size: Math.random() * 8 + 3,
                speed: Math.random() * 3 + 1,
                color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                rotation: Math.random() * 360,
                rotSpeed: Math.random() * 5 - 2.5
            });
        }

        function animateConfetti() {
            ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
            confettiPieces.forEach((piece, index) => {
                piece.y += piece.speed;
                if (piece.gravity) piece.speed += piece.gravity;
                piece.rotation += piece.rotSpeed;
                if (piece.y > confettiCanvas.height + piece.size) {
                    if (piece.gravity) {
                        confettiPieces.splice(index, 1);
                    } else {
                        piece.y = -piece.size;
                        piece.x = Math.random() * confettiCanvas.width;
                    }
                }
                ctx.save();
                ctx.translate(piece.x, piece.y);
                ctx.rotate(piece.rotation * Math.PI / 180);
                ctx.fillStyle = piece.color;
                ctx.fillRect(-piece.size / 2, -piece.size / 2, piece.size, piece.size);
                ctx.restore();
            });
            requestAnimationFrame(animateConfetti);
        }
        animateConfetti();

        // Floating balloons with starburst effect
        const balloonsCanvas = document.getElementById('balloons');
        const balloonsCtx = balloonsCanvas.getContext('2d');
        balloonsCanvas.width = window.innerWidth;
        balloonsCanvas.height = window.innerHeight;

        const balloons = [];
        const balloonColors = ['#FF0000', '#FF69B4', '#FFD700', '#00FF00', '#00B7EB'];
        function createBalloon() {
            balloons.push({
                x: Math.random() * balloonsCanvas.width,
                y: balloonsCanvas.height + 50,
                size: Math.random() * 20 + 15, // Smaller for mobile
                speed: Math.random() * 1.5 + 0.5,
                color: balloonColors[Math.floor(Math.random() * balloonColors.length)],
                sway: Math.random() * 1.5 - 0.75,
                popped: false
            });
        }

        setInterval(createBalloon, 400);

        function animateBalloons() {
            balloonsCtx.clearRect(0, 0, balloonsCanvas.width, balloonsCanvas.height);
            balloons.forEach((balloon, index) => {
                if (!balloon.popped) {
                    balloon.y -= balloon.speed;
                    balloon.x += balloon.sway * Math.sin(balloon.y / 50);
                    if (balloon.y < -balloon.size) {
                        balloons.splice(index, 1);
                        return;
                    }
                    balloonsCtx.beginPath();
                    balloonsCtx.ellipse(balloon.x, balloon.y, balloon.size * 0.7, balloon.size, 0, 0, Math.PI * 2);
                    balloonsCtx.fillStyle = balloon.color;
                    balloonsCtx.fill();
                    balloonsCtx.beginPath();
                    balloonsCtx.moveTo(balloon.x, balloon.y + balloon.size);
                    balloonsCtx.lineTo(balloon.x, balloon.y + balloon.size + 15);
                    balloonsCtx.strokeStyle = '#fff';
                    balloonsCtx.stroke();
                }
            });
            requestAnimationFrame(animateBalloons);
        }
        animateBalloons();

        // Pop balloons with starburst
        balloonsCanvas.addEventListener('click', popBalloon);
        balloonsCanvas.addEventListener('touchstart', popBalloon);

        const petNames = ['Mew', 'Madhurima', 'Cat', 'Baccha', 'Cute', 'Sweetheart', 'Love', 'Angel'];

        function popBalloon(e) {
            const rect = balloonsCanvas.getBoundingClientRect();
            const touchX = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
            const touchY = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
            balloons.forEach((balloon, index) => {
                if (!balloon.popped) {
                    const dx = touchX - balloon.x;
                    const dy = touchY - balloon.y;
                    if (Math.sqrt(dx * dx + dy * dy) < balloon.size) {
                        balloon.popped = true;
                        balloons.splice(index, 1);
                        // Starburst effect
                        for (let i = 0; i < 20; i++) {
                            confettiPieces.push({
                                x: balloon.x,
                                y: balloon.y,
                                size: Math.random() * 4 + 2,
                                speed: Math.random() * 4 + 2,
                                color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                                rotation: Math.random() * 360,
                                rotSpeed: Math.random() * 8 - 4,
                                gravity: Math.random() * 0.08 + 0.04
                            });
                        }
                        // Show pet name with animation
                        const randomName = petNames[Math.floor(Math.random() * petNames.length)];
                        const wordElement = document.createElement('div');
                        wordElement.className = 'pop-word';
                        wordElement.textContent = randomName;
                        wordElement.style.left = `${balloon.x}px`;
                        wordElement.style.top = `${balloon.y}px`;
                        document.body.appendChild(wordElement);
                        setTimeout(() => {
                            wordElement.remove();
                        }, 2000);
                        // Haptic feedback
                        if (navigator.vibrate) navigator.vibrate(50);
                        // Play music
                        const audio = document.getElementById('birthdaySong');
                        if (audio.paused) {
                            audio.play().catch(() => {});
                        }
                    }
                }
            });
        }

        // Fireworks on cake click
        const fireworksCanvas = document.getElementById('fireworks');
        const fwCtx = fireworksCanvas.getContext('2d');
        fireworksCanvas.width = window.innerWidth;
        fireworksCanvas.height = window.innerHeight;

        const fireworks = [];
        function createFirework(x, y) {
            for (let i = 0; i < 30; // Reduced for mobile
                 i++) {
                fireworks.push({
                    x: x,
                    y: y,
                    vx: Math.random() * 8 - 4,
                    vy: Math.random() * 8 - 4,
                    size: Math.random() * 4 + 2,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    life: 80,
                    gravity: 0.08
                });
            }
        }

        function animateFireworks() {
            fwCtx.clearRect(0, 0, fireworksCanvas.width, fireworksCanvas.height);
            fireworks.forEach((fw, index) => {
                fw.vy += fw.gravity;
                fw.x += fw.vx;
                fw.y += fw.vy;
                fw.life -= 1;
                if (fw.life <= 0) {
                    fireworks.splice(index, 1);
                    return;
                }
                fwCtx.beginPath();
                fwCtx.arc(fw.x, fw.y, fw.size, 0, Math.PI * 2);
                fwCtx.fillStyle = fw.color;
                fwCtx.globalAlpha = fw.life / 80;
                fwCtx.fill();
            });
            fwCtx.globalAlpha = 1;
            requestAnimationFrame(animateFireworks);
        }
        animateFireworks();

        cake.addEventListener('click', (e) => {
            createFirework(cake.offsetLeft + cake.offsetWidth / 2, cake.offsetTop + cake.offsetHeight / 2);
            const wordElement = document.createElement('div');
            wordElement.className = 'pop-word';
            wordElement.textContent = 'Wish Granted! üéá';
            wordElement.style.left = `${cake.offsetLeft}px`;
            wordElement.style.top = `${cake.offsetTop - 40}px`;
            document.body.appendChild(wordElement);
            setTimeout(() => {
                wordElement.remove();
            }, 2000);
            if (navigator.vibrate) navigator.vibrate(50);
        });

        // Gift open on click
        gift.addEventListener('click', () => {
            const message = 'My eternal love for you, Trisha! üíç‚ù§Ô∏è';
            const giftMsg = document.createElement('div');
            giftMsg.className = 'gift-message';
            giftMsg.textContent = message;
            giftMsg.style.left = `${gift.offsetLeft}px`;
            giftMsg.style.top = `${gift.offsetTop - 40}px`;
            document.body.appendChild(giftMsg);
            setTimeout(() => {
                giftMsg.remove();
            }, 3000);
            for (let i = 0; i < 30; i++) {
                confettiPieces.push({
                    x: gift.offsetLeft + gift.offsetWidth / 2,
                    y: gift.offsetTop + gift.offsetHeight / 2,
                    size: Math.random() * 4 + 2,
                    speed: Math.random() * 4 + 2,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    rotation: Math.random() * 360,
                    rotSpeed: Math.random() * 8 - 4,
                    gravity: Math.random() * 0.08 + 0.04
                });
            }
            if (navigator.vibrate) navigator.vibrate(50);
        });

        // Handle window resize for mobile
        window.addEventListener('resize', () => {
            confettiCanvas.width = window.innerWidth;
            confettiCanvas.height = window.innerHeight;
            balloonsCanvas.width = window.innerWidth;
            balloonsCanvas.height = window.innerHeight;
            fireworksCanvas.width = window.innerWidth;
            fireworksCanvas.height = window.innerHeight;
            trailCanvas.width = window.innerWidth;
            trailCanvas.height = window.innerHeight;
        });
    </script>
</body>
</html>